<!-- gx-card.html -->
<article class="gx-shape" [class]="classes">
  
  <!-- Classic Shape - 完整顯示 -->
  @if (resolvedShape() === 'classic') {
    <!-- Header -->
    <div class="gx-card-header">
      <ng-content select="[card-header]"></ng-content>
      @if (data()?.header?.avatar?.src) {
        <img class="gx-card-header-img"
             [src]="data()!.header!.avatar!.src"
             [alt]="data()!.header!.avatar!.alt || ''" />
      }
      <div class="gx-card-header-info">
        @if (data()?.header?.title)    { <h3 class="title">{{ data()!.header!.title }}</h3> }
        @if (data()?.header?.subtitle) { <p class="subtitle">{{ data()!.header!.subtitle }}</p> }
      </div>
    </div>

    <!-- Content -->
    <div class="gx-card-content">
      @if (data()?.content?.image?.src) {
        <img class="gx-card-media"
             [src]="data()!.content!.image!.src"
             [alt]="data()!.content!.image!.alt || ''" />
      }
      <!-- @if (data()?.content?.title)       { <h4>{{ data()!.content!.title }}</h4> }
      @if (data()?.content?.subtitle)    { <p class="sub">{{ data()!.content!.subtitle }}</p> } -->
      @if (data()?.content?.description) { <p>{{ data()!.content!.description }}</p> }
      <ng-content></ng-content>
    </div>

    <!-- Footer -->
    @if (data()?.footer?.actions?.length) {
      <div class="gx-card-footer">
        <div class="gx-card-actions">
          @for (a of data()!.footer!.actions; track a.id) {
            <gx-button
              [variant]="'filled'"
              [intent]="mapIntent(a.intent)"
              [disabled]="a.disabled ?? false"
              [tooltip]="a.ariaLabel || a.label"
              (pressed)="onActionPressed(a, $event)">
              {{ a.label }}
            </gx-button>
          }
        </div>
      </div>
    }
  }

  <!-- Square Shape - 簡化顯示 -->
  @else if (resolvedShape() === 'square') {
    <!-- 只顯示主要內容，省略 subtitle 和複雜的 footer -->
    <div class="gx-card-header">
      @if (data()?.header?.avatar?.src) {
        <img class="gx-card-header-img"
             [src]="data()!.header!.avatar!.src"
             [alt]="data()!.header!.avatar!.alt || ''" />
      }
      @if (data()?.header?.title) { 
        <h3 class="title">{{ data()!.header!.title }}</h3> 
      }
      <!-- 省略 subtitle -->
    </div>

    <div class="gx-card-content">
      @if (data()?.content?.image?.src) {
        <img class="gx-card-media"
             [src]="data()!.content!.image!.src"
             [alt]="data()!.content!.image!.alt || ''" />
      }
      @if (data()?.content?.title) { 
        <h4>{{ data()!.content!.title }}</h4> 
      }
      <!-- 省略 subtitle 和 description -->
      <ng-content></ng-content>
    </div>

    <!-- 最多顯示一個主要動作 -->
    @if (data()?.footer?.actions?.length && primaryAction()) {
      <div class="gx-card-footer">
        <gx-button
          [variant]="'filled'"
          [intent]="mapIntent(primaryAction()!.intent)"
          [disabled]="primaryAction()!.disabled ?? false"
          (pressed)="onActionPressed(primaryAction()!, $event)">
          {{ primaryAction()!.label }}
        </gx-button>
      </div>
    }
  }

  <!-- Landscape Shape - 橫向布局 -->
  @else if (resolvedShape() === 'landscape') {
    <div class="gx-card-header">
      <div class="gx-card-header-content">
        @if (data()?.header?.avatar?.src) {
          <img class="gx-card-header-img"
               [src]="data()!.header!.avatar!.src"
               [alt]="data()!.header!.avatar!.alt || ''" />
        }
        <div class="gx-card-header-info">
          @if (data()?.header?.title)    { <h3 class="title">{{ data()!.header!.title }}</h3> }
          @if (data()?.header?.subtitle) { <p class="subtitle">{{ data()!.header!.subtitle }}</p> }
        </div>
      </div>
    </div>

    <div class="gx-card-content">
      @if (data()?.content?.title)       { <h4>{{ data()!.content!.title }}</h4> }
      @if (data()?.content?.description) { <p>{{ data()!.content!.description }}</p> }
      <ng-content></ng-content>
      
      <!-- Landscape 不顯示內容圖片，空間有限 -->
    </div>

    <!-- 簡化的動作區域 -->
    @if (data()?.footer?.actions?.length) {
      <div class="gx-card-footer">
        <div class="gx-card-actions">
          @for (a of data()!.footer!.actions | slice:0:2; track a.id) {
            <gx-button
              [intent]="mapIntent(a.intent)"
              [disabled]="a.disabled ?? false"
              [tooltip]="a.ariaLabel || a.label"
              (pressed)="onActionPressed(a, $event)">
              {{ a.label }}
            </gx-button>
          }
        </div>
      </div>
    }
  }

  <!-- Custom Shape - 完全自定義 -->
  @else if (resolvedShape() === 'custom') {
    <ng-content></ng-content>
  }
</article>